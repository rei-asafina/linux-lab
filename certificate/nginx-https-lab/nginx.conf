# nginx.conf
# 実験用サーバー。HTTPSで “hello over https” を返す。
events {}

http {
  # HTTPS サーバー (443番ポート)
  server {
    listen 443 ssl; # ポート 443 で SSL/TLS を使用してリッスン
    server_name localhost;

    # サーバー証明書 (server.crt) と秘密鍵 (server.key) を指定
    #これにより HTTPS 通信が可能になる
    ssl_certificate     /etc/nginx/certs/server.crt;
    ssl_certificate_key /etc/nginx/certs/server.key;

    # 実験用プレーンレスポンス
    location / {
      return 200 'hello over https\n';
      add_header Content-Type text/plain;
    }
  }

  # HTTP サーバー (80番ポート)
  # 301 リダイレクトを使用して、リクエストされた URL を HTTPS に変換
  server {
    listen 80;
    return 301 https://$host:8443$request_uri;
  }
}
